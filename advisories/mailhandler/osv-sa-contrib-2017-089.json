{
  "schema_version": "1.3.0",
  "id": "OSV-SA-CONTRIB-2017-089",
  "modified": "2023-08-22T01:26:16.000Z",
  "published": "2017-12-07T07:37:34.000Z",
  "aliases": [],
  "related": [],
  "summary": "",
  "details": "The Mailhandler module enables you to create nodes by email.\n\nThe Mailhandler module does not validate file attachments. By sending a correctly crafted e-mail to a mailhandler mailbox an attacker can execute arbitrary code.\n\nThe vulnerability applies to any active mailhandler mailbox, whether or not attachments are mapped to a field.\n\n**Mitigating factors:**\n\n* For 7.x versions prior to 7.x-2.5, the vulnerability is mitigated by the fact that the 'MailhandlerCommandsFiles' plugin must be enabled. For later versions, the option to disable commands was removed, all commands are enabled in any case.\n* The vulnerability is mitigated by the fact that the attacker must pass the authentication step. The default authentication is that the attacker must send the crafted e-mail from a registered e-mail address.\n* The vulnerability is mitigated by the fact that the mailhandler mailbox e-mail address must be known by the attacker. This essentially depends on the usecase, e.g. Mailcomment module.\n* The vulnerability is mitigated by the fact that the webserver configuration must either permit the execution of some file extensions in the public filesystem or (Apache) has '.htaccess' support enabled through the AllowOverride directive.",
  "affected": [
    {
      "package": {
        "ecosystem": "Packagist",
        "name": "drupal/mailhandler"
      },
      "severity": [],
      "ranges": []
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://www.drupal.org/sa-contrib-2017-089"
    }
  ],
  "credits": [
    {
      "name": "Marc Darcis",
      "contact": [
        "https://www.drupal.org/user/3552485"
      ]
    }
  ]
}
